<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestione Affitti PRO - Villa Nausicaa e Villa Atena</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-color: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary-color: #f8fafc;
            --accent-color: #0ea5e9;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            color: var(--text-primary);
        }
        
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 25px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        .header h1 {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            margin-bottom: 8px;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        .nav-tabs {
            display: flex;
            background: var(--secondary-color);
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .nav-tabs::-webkit-scrollbar {
            display: none;
        }
        
        .nav-tab {
            flex: 1;
            min-width: max-content;
            padding: 16px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-bottom: 3px solid transparent;
            color: var(--text-secondary);
            white-space: nowrap;
        }
        
        .nav-tab:hover {
            background: rgba(37, 99, 235, 0.05);
            color: var(--primary-color);
            transform: translateY(-1px);
        }
        
        .nav-tab.active {
            background: white;
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
            box-shadow: var(--shadow-sm);
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
        }
        
        @media (min-width: 768px) {
            .tab-content {
                padding: 30px;
            }
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .villa-selector {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .villa-btn {
            padding: 12px 24px;
            background: white;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-sm);
            min-width: 140px;
        }
        
        .villa-btn.active {
            background: var(--primary-color);
            color: white;
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }
        
        .villa-btn:hover:not(.active) {
            background: var(--primary-color);
            color: white;
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        
        .calendar-container {
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            margin: 20px 0;
        }
        
        .calendar-header-row {
            display: flex;
            background: var(--primary-color);
            color: white;
        }
        
        .calendar-header {
            flex: 1;
            padding: 16px 8px;
            text-align: center;
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: var(--border-color);
        }
        
        .calendar-day {
            background: white;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            min-height: 60px;
            padding: 8px 4px;
        }
        
        @media (min-width: 768px) {
            .calendar-day {
                min-height: 80px;
                padding: 12px 8px;
            }
        }
        
        .calendar-day:hover {
            background: var(--secondary-color);
            transform: scale(1.02);
            z-index: 1;
            box-shadow: var(--shadow-md);
        }
        
        .calendar-day.other-month {
            color: var(--text-secondary);
            background: #f8fafc;
        }
        
        .calendar-day.available {
            background: #ecfdf5;
            color: var(--success-color);
            border: 2px solid #bbf7d0;
        }
        
        .calendar-day.booked {
            background: #fef2f2;
            color: var(--danger-color);
            border: 2px solid #fecaca;
        }
        
        .calendar-day.pending {
            background: #fffbeb;
            color: var(--warning-color);
            border: 2px solid #fed7aa;
        }
        
        .day-number {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 2px;
        }
        
        .booking-info {
            font-size: 10px;
            font-weight: 500;
            text-align: center;
            line-height: 1.2;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            width: 100%;
        }
        
        @media (min-width: 768px) {
            .booking-info {
                font-size: 11px;
                white-space: normal;
                overflow: visible;
            }
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            padding: 20px;
            background: var(--secondary-color);
            border-radius: 12px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid rgba(0,0,0,0.1);
        }
        
        .form-container {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (min-width: 768px) {
            .form-container {
                grid-template-columns: 1fr 1fr;
                gap: 30px;
            }
        }
        
        .form-section {
            background: var(--secondary-color);
            padding: 25px;
            border-radius: 16px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
        }
        
        .form-section h3 {
            color: var(--text-primary);
            margin-bottom: 20px;
            font-size: 1.2em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }
        
        .form-group input, 
        .form-group select, 
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
            background: white;
            color: var(--text-primary);
        }
        
        .form-group input:focus, 
        .form-group select:focus, 
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
            transform: translateY(-1px);
        }
        
        .btn {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: none;
            letter-spacing: 0.5px;
            box-shadow: var(--shadow-md);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .bookings-list {
            margin-top: 20px;
            display: grid;
            gap: 20px;
        }
        
        .booking-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .booking-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        }
        
        .booking-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }
        
        .booking-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .booking-title {
            font-size: 1.3em;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .booking-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }
        
        .status-confermata { 
            background: #d1fae5; 
            color: #065f46; 
            border: 1px solid #a7f3d0;
        }
        
        .status-pending { 
            background: #fef3c7; 
            color: #92400e; 
            border: 1px solid #fde68a;
        }
        
        .status-cancellata { 
            background: #fee2e2; 
            color: #991b1b; 
            border: 1px solid #fecaca;
        }
        
        .booking-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }
        
        @media (max-width: 767px) {
            .booking-details {
                grid-template-columns: 1fr;
                gap: 12px;
            }
        }
        
        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .detail-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        
        .detail-value {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }
        
        .month-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 16px;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
        }
        
        .month-nav-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .month-nav-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .month-nav-btn:disabled {
            background: var(--text-secondary);
            cursor: not-allowed;
            transform: none;
        }
        
        .current-month {
            font-size: 1.2em;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
            margin-top: 4px;
        }
        
        .floating-add {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 56px;
            height: 56px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .floating-add:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-xl);
        }
        
        @media (max-width: 767px) {
            .floating-add {
                bottom: 80px;
            }
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 16px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
        }
        
        .success-message {
            background: #d1fae5;
            color: #065f46;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #a7f3d0;
            display: none;
        }
        
        .error-message {
            background: #fee2e2;
            color: #991b1b;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #fecaca;
            display: none;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-container" style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 15px; position: relative; z-index: 2;">
                <div class="logo" style="display: flex; align-items: center; gap: 20px;">
                    <svg width="80" height="80" viewBox="0 0 300 200" xmlns="http://www.w3.org/2000/svg">
                        <!-- Forme curve grigie di sfondo -->
                        <path d="M50 180 Q100 120, 150 180 Q200 240, 250 180" fill="none" stroke="#64748b" stroke-width="25" opacity="0.8"/>
                        <path d="M10 60 Q60 10, 110 60 Q160 110, 210 60" fill="none" stroke="#64748b" stroke-width="20" opacity="0.7"/>
                        
                        <!-- Cerchio principale grigio -->
                        <circle cx="150" cy="100" r="65" fill="#64748b" opacity="0.9"/>
                        
                        <!-- Cerchio turchese interno -->
                        <circle cx="150" cy="100" r="45" fill="#22d3ee"/>
                        
                        <!-- Casa bianca centrata -->
                        <g fill="white" stroke="none">
                            <!-- Tetto triangolare -->
                            <path d="M125 85 L150 65 L175 85 Z"/>
                            <!-- Corpo della casa -->
                            <rect x="130" y="85" width="40" height="30"/>
                            <!-- Finestre quadrate -->
                            <rect x="135" y="90" width="8" height="8" fill="#22d3ee"/>
                            <rect x="157" y="90" width="8" height="8" fill="#22d3ee"/>
                            <!-- Porta rettangolare -->
                            <rect x="145" y="100" width="10" height="15" fill="#22d3ee"/>
                        </g>
                        
                        <!-- Elemento decorativo curvo -->
                        <path d="M220 40 Q260 20, 280 60 Q290 100, 260 120" fill="none" stroke="#64748b" stroke-width="15" opacity="0.6"/>
                    </svg>
                    <div class="brand-text" style="color: white; text-shadow: 2px 2px 6px rgba(0,0,0,0.5);">
                        <div style="font-size: 2.8em; font-weight: 900; letter-spacing: 3px; line-height: 0.9; font-family: 'Arial Black', sans-serif;">QUIRINO</div>
                        <div style="font-size: 1.4em; font-weight: 300; letter-spacing: 6px; margin-top: 5px; opacity: 0.95; font-style: italic;">residence</div>
                    </div>
                </div>
            </div>
            <p style="position: relative; z-index: 2; font-size: 1.1em; margin-top: 10px;">Gestione professionale per Villa Nausicaa & Villa Atena</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('dashboard')">📊 Dashboard</button>
            <button class="nav-tab" onclick="switchTab('calendario')">📅 Calendario</button>
            <button class="nav-tab" onclick="switchTab('prenotazioni')">📋 Prenotazioni</button>
            <button class="nav-tab" onclick="switchTab('nuova')">➕ Nuova</button>
            <button class="nav-tab" onclick="switchTab('sync')">☁️ Sync</button>
        </div>
        
        <!-- Tab Dashboard -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-bookings">3</div>
                    <div class="stat-label">Prenotazioni Totali</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="monthly-revenue">€2,200</div>
                    <div class="stat-label">Ricavi Mese</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="occupancy-rate">75%</div>
                    <div class="stat-label">Tasso Occupazione</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pending-payments">€2,100</div>
                    <div class="stat-label">Pagamenti Pendenti</div>
                </div>
            </div>
            
            <h3 style="margin-bottom: 20px; color: var(--text-primary);">📈 Prossime Prenotazioni</h3>
            <div id="upcoming-bookings">
                <div class="booking-card">
                    <div class="booking-header">
                        <div class="booking-title">Mario e Anna Rossi</div>
                        <div class="booking-status status-confermata">Confermata</div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
                        <div class="detail-item">
                            <div class="detail-label">Villa</div>
                            <div class="detail-value">Villa Nausicaa</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Check-in</div>
                            <div class="detail-value">15/07/2025</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ospiti</div>
                            <div class="detail-value">4</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tab Calendario -->
        <div id="calendario" class="tab-content">
            <div class="villa-selector">
                <button class="villa-btn active" onclick="selectVilla('nausicaa')">🏛️ Villa Nausicaa</button>
                <button class="villa-btn" onclick="selectVilla('atena')">🏛️ Villa Atena</button>
            </div>
            
            <div class="month-navigation">
                <button class="month-nav-btn" onclick="changeMonth(-1)">‹ Precedente</button>
                <div class="current-month" id="current-month">Luglio 2025</div>
                <button class="month-nav-btn" onclick="changeMonth(1)">Successivo ›</button>
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #ecfdf5; border-color: #bbf7d0;"></div>
                    <span>Disponibile</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #fef2f2; border-color: #fecaca;"></div>
                    <span>Prenotato</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #fffbeb; border-color: #fed7aa;"></div>
                    <span>In Attesa</span>
                </div>
            </div>
            
            <div class="calendar-container">
                <div class="calendar-header-row">
                    <div class="calendar-header">Lun</div>
                    <div class="calendar-header">Mar</div>
                    <div class="calendar-header">Mer</div>
                    <div class="calendar-header">Gio</div>
                    <div class="calendar-header">Ven</div>
                    <div class="calendar-header">Sab</div>
                    <div class="calendar-header">Dom</div>
                </div>
                <div class="calendar-grid" id="calendar-grid">
                    <!-- I giorni verranno generati dinamicamente -->
                    <div class="calendar-day other-month"><div class="day-number">30</div></div>
                    <div class="calendar-day available"><div class="day-number">1</div></div>
                    <div class="calendar-day available"><div class="day-number">2</div></div>
                    <div class="calendar-day available"><div class="day-number">3</div></div>
                    <div class="calendar-day available"><div class="day-number">4</div></div>
                    <div class="calendar-day available"><div class="day-number">5</div></div>
                    <div class="calendar-day available"><div class="day-number">6</div></div>
                    <div class="calendar-day available"><div class="day-number">7</div></div>
                    <div class="calendar-day available"><div class="day-number">8</div></div>
                    <div class="calendar-day available"><div class="day-number">9</div></div>
                    <div class="calendar-day available"><div class="day-number">10</div></div>
                    <div class="calendar-day available"><div class="day-number">11</div></div>
                    <div class="calendar-day available"><div class="day-number">12</div></div>
                    <div class="calendar-day available"><div class="day-number">13</div></div>
                    <div class="calendar-day available"><div class="day-number">14</div></div>
                    <div class="calendar-day booked">
                        <div class="day-number">15</div>
                        <div class="booking-info">Mario</div>
                    </div>
                    <div class="calendar-day booked">
                        <div class="day-number">16</div>
                        <div class="booking-info">Mario</div>
                    </div>
                    <div class="calendar-day booked">
                        <div class="day-number">17</div>
                        <div class="booking-info">Mario</div>
                    </div>
                    <div class="calendar-day booked">
                        <div class="day-number">18</div>
                        <div class="booking-info">Mario</div>
                    </div>
                    <div class="calendar-day booked">
                        <div class="day-number">19</div>
                        <div class="booking-info">Mario</div>
                    </div>
                    <div class="calendar-day booked">
                        <div class="day-number">20</div>
                        <div class="booking-info">Mario</div>
                    </div>
                    <div class="calendar-day booked">
                        <div class="day-number">21</div>
                        <div class="booking-info">Mario</div>
                    </div>
                    <div class="calendar-day available"><div class="day-number">22</div></div>
                    <div class="calendar-day available"><div class="day-number">23</div></div>
                    <div class="calendar-day available"><div class="day-number">24</div></div>
                    <div class="calendar-day available"><div class="day-number">25</div></div>
                    <div class="calendar-day available"><div class="day-number">26</div></div>
                    <div class="calendar-day available"><div class="day-number">27</div></div>
                    <div class="calendar-day available"><div class="day-number">28</div></div>
                    <div class="calendar-day available"><div class="day-number">29</div></div>
                    <div class="calendar-day available"><div class="day-number">30</div></div>
                    <div class="calendar-day available"><div class="day-number">31</div></div>
                </div>
            </div>
        </div>
        
        <!-- Tab Prenotazioni -->
        <div id="prenotazioni" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 16px;">
                <h2 style="color: var(--text-primary); margin: 0;">📋 Gestione Prenotazioni</h2>
                <select id="filter-status" onchange="filterBookings()" style="padding: 8px 12px; border: 2px solid var(--border-color); border-radius: 8px;">
                    <option value="">Tutte le prenotazioni</option>
                    <option value="confermata">Solo confermate</option>
                    <option value="pending">Solo in attesa</option>
                    <option value="cancellata">Solo cancellate</option>
                </select>
            </div>
            <div class="bookings-list" id="bookings-list">
                <!-- Prenotazione 1 -->
                <div class="booking-card">
                    <div class="booking-header">
                        <div class="booking-title">Mario e Anna Rossi - Villa Nausicaa</div>
                        <div class="booking-status status-confermata">Confermata</div>
                    </div>
                    <div class="booking-details">
                        <div class="detail-item">
                            <div class="detail-label">Periodo</div>
                            <div class="detail-value">15/07/2025 - 22/07/2025</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ospiti</div>
                            <div class="detail-value">4 persone</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Email</div>
                            <div class="detail-value">mario.rossi@gmail.com</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Telefono</div>
                            <div class="detail-value">+39 347 123 4567</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Prezzo Totale</div>
                            <div class="detail-value">€1,800</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Acconto</div>
                            <div class="detail-value">€540</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Saldo</div>
                            <div class="detail-value">€1,260</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Canale</div>
                            <div class="detail-value">🏠 Airbnb</div>
                        </div>
                    </div>
                    <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="email-btn" onclick="sendEmail('mario.rossi@gmail.com', 'conferma', 'Mario e Anna Rossi', 'Villa Nausicaa', '15/07/2025', '22/07/2025', '€1,800', 'QR001')" style="background: #10b981; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                            ✉️ Conferma Prenotazione
                        </button>
                        <button class="email-btn" onclick="sendEmail('mario.rossi@gmail.com', 'opzione', 'Mario e Anna Rossi', 'Villa Nausicaa', '15/07/2025', '22/07/2025', '€1,800', 'QR001')" style="background: #f59e0b; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                            📝 Opzione Prenotazione
                        </button>
                        <button class="email-btn" onclick="sendEmail('mario.rossi@gmail.com', 'recensione', 'Mario e Anna Rossi', 'Villa Nausicaa', '15/07/2025', '22/07/2025', '€1,800', 'QR001')" style="background: #3b82f6; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                            ⭐ Richiesta Recensione
                        </button>
                    </div>
                </div>
                
                <!-- Prenotazione 2 -->
                <div class="booking-card">
                    <div class="booking-header">
                        <div class="booking-title">Sarah Thompson - Villa Atena</div>
                        <div class="booking-status status-confermata">Confermata</div>
                    </div>
                    <div class="booking-details">
                        <div class="detail-item">
                            <div class="detail-label">Periodo</div>
                            <div class="detail-value">03/08/2025 - 10/08/2025</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ospiti</div>
                            <div class="detail-value">2 persone</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Email</div>
                            <div class="detail-value">sarah.thompson@outlook.com</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Telefono</div>
                            <div class="detail-value">+44 7912 345678</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Prezzo Totale</div>
                            <div class="detail-value">€1,400</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Acconto</div>
                            <div class="detail-value">€420</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Saldo</div>
                            <div class="detail-value">€980</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Canale</div>
                            <div class="detail-value">🏨 Booking.com</div>
                        </div>
                    </div>
                    <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="email-btn" onclick="sendEmail('sarah.thompson@outlook.com', 'conferma', 'Sarah Thompson', 'Villa Atena', '03/08/2025', '10/08/2025', '€1,400', 'QR002')" style="background: #10b981; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                            ✉️ Conferma Prenotazione
                        </button>
                        <button class="email-btn" onclick="sendEmail('sarah.thompson@outlook.com', 'opzione', 'Sarah Thompson', 'Villa Atena', '03/08/2025', '10/08/2025', '€1,400', 'QR002')" style="background: #f59e0b; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                            📝 Opzione Prenotazione
                        </button>
                        <button class="email-btn" onclick="sendEmail('sarah.thompson@outlook.com', 'recensione', 'Sarah Thompson', 'Villa Atena', '03/08/2025', '10/08/2025', '€1,400', 'QR002')" style="background: #3b82f6; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                            ⭐ Richiesta Recensione
                        </button>
                    </div>
                </div>
                
                <!-- Prenotazione 3 -->
                <div class="booking-card">
                    <div class="booking-header">
                        <div class="booking-title">Jean-Pierre Dubois - Villa Nausicaa</div>
                        <div class="booking-status status-pending">In Attesa</div>
                    </div>
                    <div class="booking-details">
                        <div class="detail-item">
                            <div class="detail-label">Periodo</div>
                            <div class="detail-value">20/08/2025 - 27/08/2025</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ospiti</div>
                            <div class="detail-value">6 persone</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Email</div>
                            <div class="detail-value">jp.dubois@france.fr</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Telefono</div>
                            <div class="detail-value">+33 6 12 34 56 78</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Prezzo Totale</div>
                            <div class="detail-value">€2,100</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Acconto</div>
                            <div class="detail-value">€0</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Saldo</div>
                            <div class="detail-value">€2,100</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Canale</div>
                            <div class="detail-value">📞 Diretto</div>
                        </div>
                    </div>
                    <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="email-btn" onclick="sendEmail('jp.dubois@france.fr', 'opzione', 'Jean-Pierre Dubois', 'Villa Nausicaa', '20/08/2025', '27/08/2025', '€2,100', 'QR003')" style="background: #f59e0b; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                            📝 Opzione Prenotazione
                        </button>
                        <button class="email-btn" onclick="sendEmail('jp.dubois@france.fr', 'conferma', 'Jean-Pierre Dubois', 'Villa Nausicaa', '20/08/2025', '27/08/2025', '€2,100', 'QR003')" style="background: #10b981; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                            ✉️ Conferma Prenotazione
                        </button>
                        <button class="email-btn" onclick="sendEmail('jp.dubois@france.fr', 'recensione', 'Jean-Pierre Dubois', 'Villa Nausicaa', '20/08/2025', '27/08/2025', '€2,100', 'QR003')" style="background: #3b82f6; color: white; padding: 8px 16px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 5px;">
                            ⭐ Richiesta Recensione
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tab Nuova Prenotazione -->
        <div id="nuova" class="tab-content">
            <div class="success-message" id="success-message"></div>
            <div class="error-message" id="error-message"></div>
            
            <h2 style="margin-bottom: 20px; color: var(--text-primary);">➕ Nuova Prenotazione</h2>
            <form id="booking-form">
                <div class="form-container">
                    <div class="form-section">
                        <h3>📅 Dettagli Soggiorno</h3>
                        <div class="form-group">
                            <label>Villa *</label>
                            <select id="villa" required>
                                <option value="">Seleziona Villa</option>
                                <option value="nausicaa">🏛️ Villa Nausicaa</option>
                                <option value="atena">🏛️ Villa Atena</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Check-in *</label>
                            <input type="date" id="checkin" required>
                        </div>
                        <div class="form-group">
                            <label>Check-out *</label>
                            <input type="date" id="checkout" required>
                        </div>
                        <div class="form-group">
                            <label>Numero Ospiti *</label>
                            <input type="number" id="guests" min="1" max="12" required>
                        </div>
                        <div class="form-group">
                            <label>Prezzo Totale (€) *</label>
                            <input type="number" id="price" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>Stato Prenotazione *</label>
                            <select id="status" required>
                                <option value="confermata">✅ Confermata</option>
                                <option value="pending">⏳ In Attesa</option>
                                <option value="cancellata">❌ Cancellata</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3>👤 Dati Cliente</h3>
                        <div class="form-group">
                            <label>Nome Completo *</label>
                            <input type="text" id="customer-name" required>
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="customer-email" required>
                        </div>
                        <div class="form-group">
                            <label>Telefono *</label>
                            <input type="tel" id="customer-phone" required>
                        </div>
                        <div class="form-group">
                            <label>Indirizzo</label>
                            <textarea id="customer-address" rows="3" placeholder="Via, Città, CAP, Paese"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Note</label>
                            <textarea id="notes" rows="3" placeholder="Note aggiuntive, richieste speciali, allergie..."></textarea>
                        </div>
                    </div>
                </div>
                
                <div class="form-container" style="margin-top: 20px;">
                    <div class="form-section">
                        <h3>💰 Gestione Pagamenti</h3>
                        <div class="form-group">
                            <label>Acconto Ricevuto (€)</label>
                            <input type="number" id="deposit" step="0.01" min="0" value="0">
                        </div>
                        <div class="form-group">
                            <label>Data Acconto</label>
                            <input type="date" id="deposit-date">
                        </div>
                        <div class="form-group">
                            <label>Modalità Pagamento Acconto</label>
                            <select id="deposit-method">
                                <option value="">Seleziona modalità</option>
                                <option value="bonifico">🏦 Bonifico</option>
                                <option value="paypal">💳 PayPal</option>
                                <option value="carta">💳 Carta di Credito</option>
                                <option value="contanti">💵 Contanti</option>
                                <option value="altro">🔄 Altro</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3>💳 Saldo e Scadenze</h3>
                        <div class="form-group">
                            <label>Saldo Rimanente (€)</label>
                            <input type="number" id="balance" step="0.01" readonly style="background: #f8fafc;">
                        </div>
                        <div class="form-group">
                            <label>Modalità Pagamento Saldo</label>
                            <select id="balance-method">
                                <option value="">Seleziona modalità</option>
                                <option value="bonifico">🏦 Bonifico</option>
                                <option value="paypal">💳 PayPal</option>
                                <option value="carta">💳 Carta di Credito</option>
                                <option value="contanti">💵 Contanti all'arrivo</option>
                                <option value="altro">🔄 Altro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Scadenza Saldo</label>
                            <input type="date" id="balance-due">
                        </div>
                        <div class="form-group">
                            <label>Canale di Prenotazione</label>
                            <select id="booking-channel">
                                <option value="">Seleziona canale</option>
                                <option value="airbnb">🏠 Airbnb</option>
                                <option value="booking">🏨 Booking.com</option>
                                <option value="diretto">📞 Contatto Diretto</option>
                                <option value="sito">🌐 Sito Web</option>
                                <option value="altro">🔄 Altro</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button type="submit" class="btn">
                        <span id="submit-text">💾 Salva Prenotazione</span>
                        <span id="submit-loading" class="loading" style="display: none;"></span>
                    </button>
                </div>
            </form>
        </div>
        
        <!-- Tab Sincronizzazione -->
        <div id="sync" class="tab-content">
            <h2 style="margin-bottom: 20px; color: var(--text-primary);">☁️ Sincronizzazione & Collaboratori</h2>
            
            <div class="form-container">
                <div class="form-section">
                    <h3>📱 Setup Multi-Dispositivo</h3>
                    <div class="stats-grid" style="margin-bottom: 20px;">
                        <div class="stat-card" style="background: #ecfdf5; border: 1px solid #bbf7d0;">
                            <div style="font-size: 2em; margin-bottom: 10px;">📱</div>
                            <div style="font-weight: 600; margin-bottom: 5px;">iOS/Android</div>
                            <button onclick="setupMobile()" style="background: #10b981; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">Setup PWA</button>
                        </div>
                        <div class="stat-card" style="background: #eff6ff; border: 1px solid #bfdbfe;">
                            <div style="font-size: 2em; margin-bottom: 10px;">💻</div>
                            <div style="font-weight: 600; margin-bottom: 5px;">Desktop</div>
                            <button onclick="setupDesktop()" style="background: #3b82f6; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">Setup App</button>
                        </div>
                        <div class="stat-card" style="background: #fefce8; border: 1px solid #fde047;">
                            <div style="font-size: 2em; margin-bottom: 10px;">☁️</div>
                            <div style="font-weight: 600; margin-bottom: 5px;">Cloud Sync</div>
                            <button onclick="setupCloud()" style="background: #eab308; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer;">Setup Drive</button>
                        </div>
                    </div>
                    
                    <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; border-left: 4px solid #0ea5e9;">
                        <h4 style="color: #0c4a6e; margin-bottom: 10px;">🚀 Quick Setup</h4>
                        <p style="color: #075985; margin-bottom: 10px;">Per utilizzare su tutti i dispositivi:</p>
                        <ol style="color: #075985; margin-left: 20px;">
                            <li>Salva questo file su Google Drive</li>
                            <li>Condividi cartella con collaboratori</li>
                            <li>Installa come PWA su mobile</li>
                            <li>Crea shortcut su desktop</li>
                        </ol>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3>👥 Gestione Team</h3>
                    <div class="form-group">
                        <label>Collaboratori Attivi</label>
                        <div id="team-list" style="background: white; padding: 15px; border-radius: 8px; border: 2px solid var(--border-color);">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #e5e7eb;">
                                <div>
                                    <strong>Giuseppe Capotosto</strong> <span style="background: #dc2626; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px;">ADMIN</span>
                                    <br><small style="color: #6b7280;">giuseppe@quirinoresidence.it</small>
                                </div>
                                <span style="color: #10b981;">● Online</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #e5e7eb;">
                                <div>
                                    <strong>Francesca</strong> <span style="background: #f59e0b; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px;">MANAGER</span>
                                    <br><small style="color: #6b7280;">francesca@quirinoresidence.it</small>
                                </div>
                                <span style="color: #6b7280;">● Offline</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px;">
                                <div>
                                    <strong>Staff Reception</strong> <span style="background: #10b981; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px;">STAFF</span>
                                    <br><small style="color: #6b7280;">reception@quirinoresidence.it</small>
                                </div>
                                <span style="color: #10b981;">● Online</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Invita Nuovo Collaboratore</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="email" placeholder="email@esempio.com" style="flex: 1; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px;">
                            <select style="padding: 12px; border: 2px solid var(--border-color); border-radius: 8px;">
                                <option value="staff">Staff</option>
                                <option value="manager">Manager</option>
                                <option value="admin">Admin</option>
                            </select>
                            <button onclick="inviteCollaborator()" style="background: var(--primary-color); color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer;">Invita</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-container" style="margin-top: 20px;">
                <div class="form-section">
                    <h3>💾 Backup & Export</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button onclick="exportData('json')" style="background: #10b981; color: white; padding: 15px; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
                            <span>📄</span>
                            <div>
                                <div style="font-weight: 600;">Export JSON</div>
                                <div style="font-size: 12px; opacity: 0.8;">Backup completo</div>
                            </div>
                        </button>
                        <button onclick="exportData('excel')" style="background: #059669; color: white; padding: 15px; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
                            <span>📊</span>
                            <div>
                                <div style="font-weight: 600;">Export Excel</div>
                                <div style="font-size: 12px; opacity: 0.8;">Per contabilità</div>
                            </div>
                        </button>
                        <button onclick="exportData('pdf')" style="background: #dc2626; color: white; padding: 15px; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
                            <span>📑</span>
                            <div>
                                <div style="font-weight: 600;">Export PDF</div>
                                <div style="font-size: 12px; opacity: 0.8;">Report mensile</div>
                            </div>
                        </button>
                        <button onclick="importData()" style="background: #3b82f6; color: white; padding: 15px; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 10px;">
                            <span>📥</span>
                            <div>
                                <div style="font-weight: 600;">Import Dati</div>
                                <div style="font-size: 12px; opacity: 0.8;">Ripristina backup</div>
                            </div>
                        </button>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: #fef3c7; border-radius: 8px; border-left: 4px solid #f59e0b;">
                        <h4 style="color: #92400e; margin-bottom: 10px;">⚠️ Backup Automatico</h4>
                        <p style="color: #a16207; margin-bottom: 10px;">Ultimo backup: <strong>15/06/2025 - 14:30</strong></p>
                        <p style="color: #a16207;">Prossimo backup automatico: <strong>22/06/2025 - 00:00</strong></p>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3>🔗 Links Condivisione</h3>
                    <div class="form-group">
                        <label>Link Google Drive</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" value="https://drive.google.com/drive/folders/1ABC..." readonly style="flex: 1; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: #f8fafc;">
                            <button onclick="copyLink('drive')" style="background: #4285f4; color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer;">Copia</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Link App Mobile</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" value="https://quirinoresidence.app/mobile" readonly style="flex: 1; padding: 12px; border: 2px solid var(--border-color); border-radius: 8px; background: #f8fafc;">
                            <button onclick="copyLink('mobile')" style="background: #10b981; color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer;">Copia</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>QR Code per Setup Rapido</label>
                        <div style="text-align: center; padding: 20px; background: white; border-radius: 8px; border: 2px solid var(--border-color);">
                            <div style="width: 120px; height: 120px; background: #000; margin: 0 auto; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px;">QR CODE<br>QUIRINO<br>RESIDENCE</div>
                            <p style="color: #6b7280; margin-top: 10px; font-size: 14px;">Scansiona per setup automatico</p>
                        </div>
                    </div>
                    
                    <div style="background: #ecfdf5; padding: 15px; border-radius: 8px; border-left: 4px solid #10b981;">
                        <h4 style="color: #065f46; margin-bottom: 10px;">✅ Status Sincronizzazione</h4>
                        <div style="color: #047857;">
                            <p>📱 <strong>Mobile:</strong> 3 dispositivi connessi</p>
                            <p>💻 <strong>Desktop:</strong> 2 computer attivi</p>
                            <p>☁️ <strong>Cloud:</strong> Sincronizzato 2 min fa</p>
                            <p>👥 <strong>Team:</strong> 3 collaboratori online</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button class="floating-add" onclick="switchTab('nuova')" title="Nuova Prenotazione">+</button>

    <script>
        let currentVilla = 'nausicaa';
        let currentDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();

        // Nomi dei mesi
        const monthNames = [
            'Gennaio', 'Febbraio', 'Marzo', 'Aprile', 'Maggio', 'Giugno',
            'Luglio', 'Agosto', 'Settembre', 'Ottobre', 'Novembre', 'Dicembre'
        ];

        // Funzioni per la gestione delle tab
        function switchTab(tabName) {
            // Rimuove classe active da tutte le tab e nav
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(nav => {
                nav.classList.remove('active');
            });
            
            // Attiva la tab selezionata
            document.getElementById(tabName).classList.add('active');
            
            // Trova e attiva il nav-tab corrispondente
            const navTabs = document.querySelectorAll('.nav-tab');
            const tabTexts = ['📊 Dashboard', '📅 Calendario', '📋 Prenotazioni', '➕ Nuova'];
            const tabIds = ['dashboard', 'calendario', 'prenotazioni', 'nuova'];
            const index = tabIds.indexOf(tabName);
            if (index !== -1 && navTabs[index]) {
                navTabs[index].classList.add('active');
            }
        }

        // Selezione villa
        function selectVilla(villa) {
            currentVilla = villa;
            document.querySelectorAll('.villa-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            // Qui si potrebbe rigenerare il calendario per la villa selezionata
        }

        // Navigazione mesi
        function changeMonth(direction) {
            currentMonth += direction;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            document.getElementById('current-month').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            // Qui si potrebbe rigenerare il calendario
        }

        // Filtro prenotazioni
        function filterBookings() {
            const filter = document.getElementById('filter-status').value;
            const bookingCards = document.querySelectorAll('.booking-card');
            
            bookingCards.forEach(card => {
                if (!filter) {
                    card.style.display = 'block';
                } else {
                    const status = card.querySelector('.booking-status');
                    if (status && status.classList.contains(`status-${filter}`)) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                }
            });
        }

        // Calcolo automatico saldo
        function calculateBalance() {
            const price = parseFloat(document.getElementById('price').value) || 0;
            const deposit = parseFloat(document.getElementById('deposit').value) || 0;
            const balance = Math.max(0, price - deposit);
            document.getElementById('balance').value = balance.toFixed(2);
        }

        // Gestione form nuova prenotazione
        document.getElementById('booking-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const submitText = document.getElementById('submit-text');
            const loadingSpinner = document.getElementById('submit-loading');
            const successMsg = document.getElementById('success-message');
            
            // Mostra loading
            submitText.style.display = 'none';
            loadingSpinner.style.display = 'inline-block';
            
            // Simula salvataggio
            setTimeout(() => {
                const customerName = document.getElementById('customer-name').value;
                
                // Mostra messaggio di successo
                successMsg.textContent = `✅ Prenotazione per ${customerName} salvata con successo!`;
                successMsg.style.display = 'block';
                
                // Reset form
                this.reset();
                document.getElementById('balance').value = '0.00';
                
                // Ripristina pulsante
                submitText.style.display = 'inline';
                loadingSpinner.style.display = 'none';
                
                // Nascondi messaggio dopo 5 secondi
                setTimeout(() => {
                    successMsg.style.display = 'none';
                }, 5000);
                
                // Scroll to top
                document.getElementById('nuova').scrollTop = 0;
            }, 1000);
        });

        // Event listeners
        document.getElementById('price').addEventListener('input', calculateBalance);
        document.getElementById('deposit').addEventListener('input', calculateBalance);

        // Auto-imposta scadenza saldo al check-in
        document.getElementById('checkin').addEventListener('change', function() {
            const checkinDate = this.value;
            if (checkinDate && !document.getElementById('balance-due').value) {
                document.getElementById('balance-due').value = checkinDate;
            }
        });

        // Imposta data minima (oggi)
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('checkin').min = today;
        document.getElementById('checkout').min = today;

        // Auto-aggiorna check-out quando cambia check-in
        document.getElementById('checkin').addEventListener('change', function() {
            const checkinDate = new Date(this.value);
            checkinDate.setDate(checkinDate.getDate() + 1);
            document.getElementById('checkout').min = checkinDate.toISOString().split('T')[0];
        });

        // Aggiungi event listeners per la navigazione via click sui nav-tab
        document.querySelectorAll('.nav-tab').forEach((tab, index) => {
            tab.addEventListener('click', function() {
                const tabIds = ['dashboard', 'calendario', 'prenotazioni', 'nuova', 'sync'];
                switchTab(tabIds[index]);
            });
        });

        // Funzione per inviare email precompilate
        function sendEmail(email, tipo, nomeCliente, villa, checkin, checkout, prezzo, codicePrenotazione) {
            let oggetto = '';
            let corpo = '';
            const mittente = 'info@quirinoresidence.it';
            
            switch(tipo) {
                case 'conferma':
                    oggetto = `Conferma Prenotazione ${codicePrenotazione} - Quirino Residence`;
                    corpo = `Gentile Sig/ra ${nomeCliente}

Con le presente abbiamo il piacere di confermarvi la prenotazione presso la nostra struttura, n° ${codicePrenotazione} dal ${checkin} al ${checkout}, per gli ospiti prenotati.

Ricordiamo inoltre che il check in può essere fatto dopo le ore 15.00 del giorno di arrivo, e il check out entro le 10.00 del giorno di partenza.

In allegato troverà il riepilogo dettagliato della sua prenotazione.

In Attesa di potervi dare personalmente il nostro benvenuto,
Vi inviamo i nostri più cordiali saluti

***Quirino Residence***

--
Quirino Residence
Via [Indirizzo], Gaeta (LT)
Tel: 329.9322748
Email: info@quirinoresidence.it`;
                    break;

                case 'opzione':
                    oggetto = `Opzione Prenotazione ${codicePrenotazione} - Quirino Residence`;
                    corpo = `Spett.le Sig/ra ${nomeCliente}

Grazie per averci scelti! La presente è per confermarle l'opzione di prenotazione per la soluzione da lei scelta, per il periodo ${checkin} - ${checkout} di ${prezzo} numero prenotazione ${codicePrenotazione}

La seguente non è una lettera confirmatoria, ma un semplice riepilogo della sua prenotazione, ed ha una validità di 48h. La prenotazione è da considerarsi valida al ricevimento della caparra confirmatoria.

In allegato trova tutte le informazioni rigurdanti la sua prenotazione e le modalità di invio della caparra, che deve essere almeno del 50% dell'importo netto (esclusa la voce Imposta di Soggiorno)

1 Posto Auto Privato

In Attesa di averla finalmente nostro ospite.
Cordialmente
QUIRINO RESIDENCE 329.9322748

**PUÒ INVIARCI LA CAPARRA TRAMITE:**

***Bonifico Bancario***
IBAN: IT40W0364601600526509298002
BIC: NTSBITM1XXX
INTESTATO A: CAPOTOSTO GIUSEPPE
CAUSALE: Caparra ${nomeCliente} ${codicePrenotazione}

***PostePay***
POSTEPAY: 5333171157144920
INTESTATO A: CAPOTOSTO GIUSEPPE
CF: CPTGPP85L06D662A

***Carta di Credito***
[Disponibile su richiesta]

--
Quirino Residence
Via [Indirizzo], Gaeta (LT)
Tel: 329.9322748
Email: info@quirinoresidence.it`;
                    break;

                case 'recensione':
                    oggetto = `Grazie per il vostro soggiorno - Quirino Residence`;
                    corpo = `Ciao ${nomeCliente},

Ti ringraziamento sentitamente per aver scelto Quirino Residence per il tuo recente soggiorno a Gaeta. È stato per noi un piacere averti avuto nostro ospite, e ci auguriamo che il tuo soggiorno sia trascorso al meglio!

Ti chiediamo cortesemente di dedicarci qualche minuto per condividere la tua opinione con una veloce recensione sulla tua piattaforma online preferita. Per te significa dedicarci solo un minuto del tuo tempo, per noi invece la tua recensione ha un valore inestimabile.

Se sei stato bene e se per qualche giorno siamo riusciti a farti sentire un pò a casa, ricordati che il tuo punteggio è determinante per la nostra piccola attività!

Per noi l'opinione e la soddisfazione dei nostri ospiti è fondamentale e ci aiuta a comprendere quali sono i nostri punti di forza e dove, invece, dovremmo migliorare. Condividendo a più persone quello che di più ci sta a cuore... La Vostra Soddisfazione!

**Clicca qui:**
• Google: [Link Google Reviews]
• TripAdvisor: [Link TripAdvisor]
• Facebook: [Link Facebook]

Per ringraziarti del tempo che ci hai donato e della tua preziosissima opinione, ti offriamo uno sconto del 10% per il tuo prossimo soggiorno! *Prenotando dal nostro SITO e aggiungendo il Coupon "FEEDBACK10"

Con la speranza di riaverti nuovamente come nostro ospite...
Grazie di Cuore
A presto

Giuseppe e Francesca
QUIRINO RESIDENCE

--
Quirino Residence
Via [Indirizzo], Gaeta (LT)
Tel: 329.9322748
Email: info@quirinoresidence.it`;
                    break;
            }
            
            // OPZIONE 1: Gmail Web Interface (Funziona sempre)
            const gmailUrl = `https://mail.google.com/mail/?view=cm&fs=1&to=${email}&su=${encodeURIComponent(oggetto)}&body=${encodeURIComponent(corpo)}`;
            
            // OPZIONE 2: Outlook Web Interface 
            const outlookUrl = `https://outlook.live.com/mail/0/deeplink/compose?to=${email}&subject=${encodeURIComponent(oggetto)}&body=${encodeURIComponent(corpo)}`;
            
            // OPZIONE 3: Client email locale (come prima)
            const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(oggetto)}&body=${encodeURIComponent(corpo)}`;
            
            // Mostra popup per scegliere il metodo
            const scelta = confirm(
                `Come vuoi inviare l'email a ${email}?\n\n` +
                `✅ OK = Gmail Web (consigliato)\n` +
                `❌ Annulla = Client Email Locale`
            );
            
            if (scelta) {
                // Apre Gmail Web con email precompilata
                window.open(gmailUrl, '_blank');
                
                // Mostra notifica di successo
                setTimeout(() => {
                    alert(`📧 Email "${oggetto}" aperta in Gmail!\n\nRicordati di:\n• Verificare il mittente (info@quirinoresidence.it)\n• Aggiungere eventuali allegati\n• Inviare l'email`);
                }, 1000);
            } else {
                // Usa client email locale
                window.location.href = mailtoLink;
            }
        }
    </script>
</body>
</html>
